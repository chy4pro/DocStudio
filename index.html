<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocStudio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/modern.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/conversation.css">
    <link rel="stylesheet" href="css/workspace.css">
    <link rel="stylesheet" href="css/document.css">
    <link rel="stylesheet" href="css/setting.css">
    <link rel="stylesheet" href="css/endless-note.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="app-container animate-fade-in">
        <header>
            <h1>DocStudio</h1>
            <div class="header-buttons">
                <button id="notesLibraryBtn" class="button-outline">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor" d="M14 14.5a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1 0-1h7a.5.5 0 0 1 .5.5zm2-4a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1 0-1h9a.5.5 0 0 1 .5.5zm-2-3.5a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1 0-1h7a.5.5 0 0 1 .5.5zm-9.7 12h9.4c1.2 0 2.3-1.1 2.3-2.3V4.3C16 3.1 14.9 2 13.7 2H4.3C3.1 2 2 3.1 2 4.3v12.4c0 1.2 1.1 2.3 2.3 2.3z" stroke="currentColor" stroke-width="0.5"></path>
                    </svg>
                    Notes Library
                </button>
                <button id="aiChatBtn" class="button-outline">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor" d="M19.2 4.8H4.8C3.8 4.8 3 5.6 3 6.6v9.6c0 1 .8 1.8 1.8 1.8h2.4v2.4l4.8-2.4h7.2c1 0 1.8-.8 1.8-1.8V6.6c0-1-.8-1.8-1.8-1.8zM9 12.6H7.2v-1.8H9v1.8zm4.8 0h-1.8v-1.8h1.8v1.8zm4.8 0h-1.8v-1.8h1.8v1.8z" stroke="currentColor" stroke-width="0.5"></path>
                    </svg>
                    AI Chat
                </button>
                <button id="chatLeftBtn" class="button-icon" title="Dock AI Chat to left">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="none" stroke="currentColor" stroke-width="2" d="M18 3v18M6 3v18M6 12h12"></path>
                    </svg>
                </button>
                <button id="chatRightBtn" class="button-icon" title="Dock AI Chat to right">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="none" stroke="currentColor" stroke-width="2" d="M6 3v18M18 3v18M6 12h12"></path>
                    </svg>
                </button>
                <button id="settingsBtn" class="button-outline">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor" d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" stroke="currentColor" stroke-width="0.5"></path>
                    </svg>
                    Settings
                </button>
            </div>
        </header>
        
        <main class="app-main">
            <!-- Left sidebar -->
            <aside id="leftSidebar" class="sidebar hidden">
                <div class="sidebar-header">
                    <h2 id="leftSidebarTitle">Notes Library</h2>
                    <button id="closeLeftSidebarBtn" class="button-icon">
                        <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                            <path fill="none" stroke="currentColor" stroke-width="2" d="M18 6L6 18M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="leftSidebarContent" class="sidebar-content">
                    <!-- Content will be dynamically inserted here -->
                </div>
            </aside>

            <!-- Main workspace area -->
            <section class="workspace-container">
                <div class="workspace-header">
                    <h2>Workspace</h2>
                    <div class="workspace-tabs" id="workspaceTabs">
                        <button class="tab active" data-id="workspace1">Workspace 1</button>
                        <button id="newWorkspaceBtn" class="new-tab">+ New</button>
                    </div>
                </div>
                <div id="workspaceArea" class="workspace-area">
                    <!-- Text editor -->
                    <textarea id="editor" class="workspace-editor"></textarea>
                    
                    <!-- Notes area (for positioned notes) -->
                    <div id="notesArea" class="notes-area"></div>
                </div>
                <div class="workspace-controls">
                    <div class="prompt-container">
                        <input type="text" id="generatePrompt" placeholder="Enter prompt for generation..." class="prompt-input">
                        <button id="generateDocBtn" class="button-primary">
                            <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                                <path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-8 3.58-8 8 0 4.42 3.58 8 8 8 3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" stroke="currentColor" stroke-width="0.5"></path>
                            </svg>
                            Generate
                        </button>
                    </div>
                </div>
            </section>

            <!-- Right sidebar -->
            <aside id="rightSidebar" class="sidebar hidden">
                <div class="sidebar-header">
                    <h2 id="rightSidebarTitle">AI Chat</h2>
                    <button id="closeRightSidebarBtn" class="button-icon">
                        <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                            <path fill="none" stroke="currentColor" stroke-width="2" d="M18 6L6 18M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="rightSidebarContent" class="sidebar-content">
                    <!-- Content will be dynamically inserted here -->
                </div>
            </aside>
        </main>
            
        <!-- Document Preview Section -->
        <section class="document-section card" id="documentSection">
            <div class="document-header">
                <h2>Document Preview</h2>
                <div class="preview-controls">
                    <button id="editDocumentBtn" class="button-outline">‚Üê Back to Edit</button>
                    <button id="openInNewWindowBtn" class="button-outline">Open in New Window</button>
                    <button id="exportPdfBtn" class="button-primary">Export PDF</button>
                    <button id="exportDocBtn" class="button-primary">Export DOC</button>
                </div>
            </div>
            <div class="preview-container">
                <div class="preview-content" id="previewContent"></div>
            </div>
        </section>
        
        <!-- Settings Modal -->
        <div id="settingsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>API Settings</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="apiEndpoint">API Endpoint:</label>
                        <input type="text" id="apiEndpoint" placeholder="https://api.example.com/v1/chat/completions">
                    </div>
                    <div class="form-group">
                        <label for="apiKey">API Key:</label>
                        <input type="password" id="apiKey" placeholder="Your API Key">
                    </div>
                    <div class="form-group">
                        <label for="modelName">Model Name:</label>
                        <input type="text" id="modelName" placeholder="gpt-3.5-turbo">
                    </div>
                    
                    <div class="form-group">
                        <label for="advancedSettings">Advanced Settings:</label>
                        <div class="advanced-toggle">
                            <input type="checkbox" id="showAdvancedSettings"> 
                            <label for="showAdvancedSettings">Show advanced settings</label>
                        </div>
                    </div>
                    
                    <div id="advancedSettingsPanel" style="display: none;">
                        <div class="form-group">
                            <label for="requestFormat">Request Format:</label>
                            <select id="requestFormat">
                                <option value="openai">OpenAI Compatible</option>
                                <option value="custom">Custom Format</option>
                            </select>
                        </div>
                        
                        <div id="customFormatFields" style="display: none;">
                            <div class="form-group">
                                <label for="customRequestTemplate">Custom Request JSON:</label>
                                <textarea id="customRequestTemplate" rows="8" placeholder='{
  "model": "${model}",
  "messages": [
    {
      "role": "user",
      "content": "${message}"
    }
  ]
}'></textarea>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="debugMode">
                                <input type="checkbox" id="debugMode"> Enable Debug Mode
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button id="saveSettingsBtn" class="button-primary">Save Settings</button>
                        <button id="testConnectionBtn" class="button-outline">Test Connection</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Context Menu for Selected Text -->
    <div id="contextMenu" class="context-menu">
        <button id="addToWorkspaceBtn">Add to Workspace</button>
        <button id="addAsNoteBtn">Save as Note</button>
    </div>
    
    <!-- Floating AI Chat -->
    <div id="floatingChat" class="floating-chat hidden">
        <div class="floating-chat-header">
            <h2>AI Chat</h2>
            <div class="floating-chat-controls">
                <button id="dockChatLeftBtn" class="button-icon" title="Dock to left">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="none" stroke="currentColor" stroke-width="2" d="M18 3v18M6 3v18M6 12h12"></path>
                    </svg>
                </button>
                <button id="dockChatRightBtn" class="button-icon" title="Dock to right">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="none" stroke="currentColor" stroke-width="2" d="M6 3v18M18 3v18M6 12h12"></path>
                    </svg>
                </button>
                <button id="closeFloatingChatBtn" class="button-icon">
                    <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="none" stroke="currentColor" stroke-width="2" d="M18 6L6 18M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        </div>
        <div id="floatingChatContent" class="floating-chat-content">
            <!-- AI chat content will be inserted here -->
        </div>
    </div>

    <!-- Display Space Overlay -->
    <div id="displayOverlay" class="display-overlay hidden">
        <div class="display-container">
            <div class="display-header">
                <h2>Generated Content</h2>
                <div class="display-controls">
                    <button id="openDisplayInNewWindowBtn" class="button-outline" title="Open in new window">
                        <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                            <path fill="none" stroke="currentColor" stroke-width="2" d="M15 3h6v6M14 10l7-7M10 3H3v18h18v-7"></path>
                        </svg>
                    </button>
                    <button id="closeDisplayBtn" class="button-icon">
                        <svg class="icon" viewBox="0 0 24 24" width="18" height="18">
                            <path fill="none" stroke="currentColor" stroke-width="2" d="M18 6L6 18M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>
            <div id="displayContent" class="display-content">
                <!-- Generated content will be displayed here -->
            </div>
        </div>
    </div>
    
    <script src="js/storage.js"></script>
    <script src="js/debug.js"></script>
    <script src="js/llm-api.js"></script>
    <script src="js/notes.js"></script>
    <script src="js/conversation.js"></script>
    <script src="js/workspace.js"></script>
    <script src="js/document.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
